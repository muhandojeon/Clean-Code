# 3장 함수

### 작게 만들어라

### 블록과 들여쓰기

- 블록 안에서 호출하는 함수 이름을 적절히 짓는다면, 코드를 이해하기도 쉬워진다

### 한 가지만 해라

- 함수를 만드는 이유는 큰 개념을 다음 추상화 수준에서 여러 단계로 나눠 수행하기 위해
- 의미 있는 이름으로 다른 함수를 추출할 수 있다면 그 함수는 여러 작업을 하는 셈이다

### 함수 당 추상화 수준은 하나로

- 한 함수 내에 추상화 수준을 섞으면 코드를 읽는 사람이 헷갈린다
- 위에서 아래로 코드 읽기 내려가기 규칙
- 위에서 아래로 프로그램을 읽으면 함수 추상화 수준이 한 단계씩 낮아진다

### Switch 문

- 본질적으로 switch 문은 N가지를 처리한다
- 이를 해결하려면 switch 문을 추상 팩토리에 숨긴다
- 물론 불가피한 상황도 생긴다

### 서술적인 이름을 사용하라

- 코드를 읽으면서 짐작했던 기능을 각 루틴이 그대로 수행한다면 깨끗한 코드라 불러도 되겠다
- 함수가 작고 단순할수록 서술적인 이름을 고르기도 쉬워진다
- 길고 서술적인 이름이 길고 서술적인 주석보다 좋다
- 이름을 붙일 때는 일관성이 있어야 한다
- 모듈 내에서 함수 이름은 같은 문구, 명사, 동사를 사용한다

### 함수 인수

- 함수에서 이상적인 인수 개수는 0개다
- 인수가 많으면 코드를 읽는 사람이 현 시점에서 별로 중요하지 않은 세부사항을 알아야 한다
- 테스트 관점에 보면 인수마다 유효한 값으로 모든 조합을 구성해 테스트하기 힘들다
- 최선은 입력 인수가 없는 경우이다

많이 쓰는 단항 형식

- 이유1 - 인수에 질문을 던지는 경우
- 이유2 - 인수를 뭔가로 변환해 결과를 반환하는 경우
- 함수 이름을 지을 때는 명령과 조회를 분명히 구분하고 일관적인 방식으로 두 형식을 사용해야 한다
- 아주 유용한 단항 함수 형식으로 이벤트가 있다
    - 입력 인수만 있고 출력 인수는 없다
    - 이벤트라는 사실이 코드에 명확히 드러나야 한다
- 지금까지 설명한 경우가 아니라면 단항 함수는 가급적 피한다

플래그 인수

- 함수로 부울 값을 넘기는 관례는 끔찍
- 함수가 한꺼번에 여러 가지를 처리한다고 대놓고 공표하는 셈

### 부수 효과를 일으키지 마라

- 시간적인 결합이나 순서 종속성을 초래한다
- 출력 인수는 피해야 한다
- 함수가 속한 객체 상태를 변경하는 방식을 택한다

### 명령과 조회를 분리하라

- 함수는 뭔가를 수행하거나 뭔가에 답하거나 둘 중 하나만 해야 한다
- ‘set’이라는 단어는 동사인지 형용사인지 분간하기 어렵다
- 진짜 해결책은 명령과 조회를 분리해 애초에 뿌리뽑아야 한다

### 오류 코드보다 예외를 사용하라

- 오류 코드는 여러 단계로 중첩되는 코드를 야기한다
- 오류 코드를 반환하면 오류 코드를 곧바로 처리해야 한다는 문제에 부딪힌다
- 오류 코드 대신 예외를 사용하면 오류 처리 코드가 원래 코드에서 분리되므로 코드가 깔끔해진다

Try/Catch 블록 뽑아내기

- 코드 구조에 혼란을 일으키며, 정상 동작과 오류 처리 동작을 뒤섞는다
- 별도 함수로 뽑아내는 편이 좋다
- 정상 동작과 오류 처리 동작을 분리하면 코드를 이해하고 수정하기 쉬워진다

오류 처리도 한 가지 작업이다

- 오류 코드를 반환한다는 이야기는, 클래스든 열거형 변수든, 어디선가 오류 코드를 정의한다는 뜻이다
- Error 클래스 변경은 어려워진다

### 반복하지 마라

- 코드 길이가 늘어날 뿐 아니라 알고리즘이 변하면 네 곳이나 손봐야 한다
- DB 정규형, 객체 지향 프로그래밍, AOP, COP들은 전부 중복 제거 전략으로 볼 수 있다

### 구조적 프로그래밍

- 데이크스트라의 구조적 프로그래밍 원칙에 의하면 모든 함수와 함수 내 모든 블록에 입구와 출구가 하나만 존재해야 한다고 한다
- 즉, return 문이 하나이며, 루프에서는 break나 continue를 사용해서는 안 되며 goto는 절대로 안된다
- 하지만 이는 함수가 아주 클 때만 상당한 이익을 제공한다
- 함수를 작게 만든다면 return, break, continue를 여러 차례 사용해도 괜찮다
- 반면 goto 문은 큰 함수에서만 의미가 있으므로, 작은 함수에서는 피해야만 한다

### 함수를 어떻게 짜죠?

- 처음에는 완벽하지 않다
- 그 서투른 코드라도 이를 테스트하는 단위 테스트 케이스는 필수적이다
- 이후 코드를 다듬고, 함수를 만들고, 이름을 바꾸고, 중복을 제거한다
